// Code generated by cliautor 0.0.0 DO NOT EDIT.
package main

import (
	"fmt"
	"bytes"
	"strings"

	cliautor_schema "cliautor/schema"
	cliautor_golang "cliautor/golang"
)

func newSchema() *cliautor_schema.Schema {
	var schema, _ = cliautor_schema.Load(bytes.NewBufferString("name: greet\nversion: \"\"\ndescription: this is an example program\noptions:\n  -help:\n    short: -h\n    description: Show help information.\n    type: boolean\n    default: \"\"\narguments: []\nsubcommands:\n  hello:\n    description: Prints \"Hello, <target name>! My name is <greeter>!\"\n    options:\n      -target-name:\n        short: -t\n        description: The name of the person to be said hello.\n        type: \"\"\n        default: \"\"\n    arguments:\n    - name: greeter\n      description: The name of the person who says hello.\n      type: \"\"\n      variadic: false\n    subcommands: {}\n"))
	return schema
}


type Func[Input any] func(subcommand []string, input Input) (err error)




type CLI struct {
	Sub_Hello CLI_Hello

	Func Func[CLI_Input]
}

type CLI_Input struct {
	Opt_Help bool


}







type CLI_Hello struct {

	Func Func[CLI_Hello_Input]
}

type CLI_Hello_Input struct {
	Opt_TargetName string

	Arg_Greeter string

}




func NewCLI() CLI {
	cli := CLI{}

	cli.Func = cliautor_golang.NewDefaultFunc[CLI_Input]()


	cli.Sub_Hello.Func = cliautor_golang.NewDefaultFunc[CLI_Hello_Input]()

	return cli
}


func Run(cli CLI, args []string) error {
	cmd, subcommand, restArgs := cliautor_golang.ResolveSubcommand(newSchema(), args)
	switch strings.Join(subcommand, " ") {

	case "":
		input := CLI_Input{
			Opt_Help: false,

		}
		if err := cliautor_golang.ResolveInput(cmd, restArgs, &input); err != nil {
			return fmt.Errorf("fail to resolve input: %w", err)
		}
		funcMethod := cli.Func
		if funcMethod == nil {
			return fmt.Errorf("%q is unsupported: cli.Func not assigned", "")
		}
		if err := funcMethod(subcommand, input); err != nil {
			return fmt.Errorf("cli.Func(input) failed: %w", err)
		}


	case "hello":
		input := CLI_Hello_Input{
			Opt_TargetName: "",

		}
		if err := cliautor_golang.ResolveInput(cmd, restArgs, &input); err != nil {
			return fmt.Errorf("fail to resolve input: %w", err)
		}
		funcMethod := cli.Sub_Hello.Func
		if funcMethod == nil {
			return fmt.Errorf("%q is unsupported: cli.Sub_Hello.Func not assigned", "hello")
		}
		if err := funcMethod(subcommand, input); err != nil {
			return fmt.Errorf("cli.Sub_Hello.Func(input) failed: %w", err)
		}

	}
	return nil
}
